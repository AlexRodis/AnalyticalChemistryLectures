# Πειραματικός Σχεδιασμός

>**Πειραματικός Σχεδιασμός:**\
Είναι η συστηματική στατιστική μελέτη των πειραματικών αποκρίσεων.

Στόχος του σωστού πειραματικού σχεδιασμού είναι η βελτιστοποίηση των πειραματικών παραμέτρων. Δηλαδή η εύρεση αυτών των τιμών πειραματικών παραμέτρων, που δίνουν τη καλύτερη απόκριση. Στόχος μας είναι να εξάγουμε τον μεγαλύτερο ποσό πληροφορίας από τον μικρότερο δυνατό αριθμό πειραμάτων.

Η παράμετρος που στοχεύουμε να βελτιστοποιήσουμε μπορεί να είναι το σήμα, η απόδοση κάποιας αντίδρασης, ο διαχωρισμός, ο χρόνος έκλουσης η συμμετρία των κορυφών ή και κάποιος γραμμικός συνδιασμός τους. Η εκάστοτε παράμετρος αναφέρεται ως *απόκριση*.

>**Βασική ορολογία:**\
**Παράμετρος:** Μια ελέγχόμενη ανεξάρτητη μεταβλητή. Μπορεί να είναι ποσοτική ή και ποιοτική.\
**Επίπεδα:** είναι οι διακριτές τιμές τις οποίες μπορεί να πάρει ο παράγωντας\
**Απόκριση:** Είναι το αποτέλεσμα της μετρούμενης παραμέτρου στις διάφορες τιμές των παραγόντων\
**Κύρια Επίδραση:** Είναι η μέση επίδραση ενός παράγοντα επό όλων των παραμέτρων και των επιμέρους τιμών τους (πρώτης τάξης)\
**Αλληλεπίδραση:**Είναι η επίδραση ενός παράγοντα ($\alpha$) σε έναν παράγοντα ($\beta$) ή και μεγαλύτερης τάξης, επί του ίδου παράγοντα [??] ($\alpha^2$)

## Στρατιγηκές Πειραματικού Σχεδιασμού

### Οικοδόμηση Σχεδιασμού

Καταρχάς καθορίζουμε τον γενικό στόχο της βελτίωσης, καθορίζουμε των μεταβλητών που θα ελέξουμε, καθορίζουμε τις παραμέτρους που θα μετρηθούν (*αποκρίσεις*) επιλέγουμε κάποια τυποποιημένα μοντέλα (πχ Simplex) και εκτελούμε τα πειράματα. Δεν ξεκινάμε εκ του μηδενός γενικά αλλά συνήθως κάνουμε κάποια "προκαρκτικά πειράματα".Με αυτό τον τρόπο προσδιορίζουμε τα **όρια** εντός των οποίων θα μελετήσουμε τις μεταβολές απόκρισης. Κάποιες φορές τα όρια είναι γνωστά εκ των προτέρων όπως πχ για τη θέρμανση μπορεί να είναι το σημειο ζέσεως του διαλύτη.

Αν κάνουμε βελτιστοποίση για πολλαπλές διαφορετικές αποκρίσεις, συχνά πρέπει να βρούμε ένα συνδιασμό μεταξύ των δύο. 

### Μέθοδος Σάρωσης

Ονομάζεται και *Screening Design*. Υπάρχουν δύο υποκατηγορίες, ο *πλήρης* παραγωντικός και *κλασματικός* παραγωντικός σχεδιασμός. 
Είναι μια προκαρτακτική διαδικάσία με την οποία στοχεύουμε να εντοπίσουμε αυτούς τους παράγωντες που έχουν ουσιαστικά έντονη επίδραση στη απόκριση. Σε μεταγενέστερο βήμα, χρησιμοποιούμε, άλλους τύπους σχεδιασμού για τις βελτιστοποιήσουμε
Εισάγουμε κάποιες αποκρίσεις και κάνουμε λίγα πειράματα και εξαιτάζουμε δύο επίπεδα, ένα υψηλό (+1) και ένα χαμηλό (-1). Οι τιμές $\pm$ 1 και 0 χρησιμοποιούντε για κανονικοποίηση μεταξύ των παραμέτρων (πχ το pH είναι 1/14 αλλά η θερμοκρασίσ μπορεί να είναι -20-150). Η μέθοδος απαιτεί **ακριβως** 12 παραμέτρους. Αν έχουμε λιγότερες (που ειναι και το συνηθέστερο) εισάγουμε fake παραμέτρους που δεν επιρρεάζουν τα αποτελέσματα (επιλέγονται με κατάλληλο μαθηματικό τρόπο ώστε να έχουν αυτή την ιδιότητα).
Το αποτέλεσμα είναι μια αποικόνηση των παραμέτρων πάνω σε μια half-normal κατανομή (ή μπορεί και σε κανονική). Οι παράμετροι που είναι πάνω στη κατανομή είναι μη-σημαντικές ενώ αυτές που απέχουν αισθητά είναι σημαντικές. Εξαιτάζουμ επίσης την πιθανή σημαντικότητα με την τεχνική ANOVA, και μέσω διαγράμματος υπολοιπων (residuals).

>**Παρατήρηση:**\
Είναι προφανές ότι δεν μπορεί μια dummy παράμετρος να εμφανίζει στατιστικά σημαντική επίδραση στην απόκριση.

Εναλλακτικά τα αποτελέσματα μπορούμε να τα απεικονίσουμε σε ένα άλλο διάγραμμα με μπάρες το *Pareto Plot*. Τότε τα όρια σημαντικότητας είναι σαφέστερα (το διάγραμμα συμπεριλαμβάνει αυστηρό κατώφλι αποκοπής). Σε ένα Pereto Plot απεικονίζεται η πυκνότητα της συμαντικότητας επίδρασης [??]. Σε αυτή τη μεθοδολογία μπορούμε να δώσουμε και αλληλεπιδράσεις μεταξύ παραγώντων τύπου $(x_ix_{j\ne i})$.
Γενικά χρησιμοποιούμε τεχνικές σάρωσης για να εντοπίσουμε αυτές τις παραμέτρους που ασκούν σημαντική επιρροή στα αποτελέσματα της μεθόδου, εντοπίζουμε τα επιτρεπτά όρια τους (πχ η θερμοκρασία μας δεν μπορεί να υπερβαίνει το σημείο ζέσεως του διαλύτη) και αυτούς του εξαιτάζουμε ως παράγωντας με μια από τις ακόλουθες μεθόδους. Κάνουμε κάποια απλά προκατακτικά πειράματα και βελτιστοποιούμε τους μη-σημαντικούς/κρίσημους παράγωντες, ενώ για τους σημαντικούς εφαρμόζουμε πολυπλοκότερες και ακριβέστερες τεχνικές:

### Σχεδιασμός Μία Παράμετρος Τη Φορά

Είναι η απλούστερη προσέγγιση. Για κάθε παράμετρο $(x_1,x_2,x_3,[\;\dots],x_n)$ δοκιμάζονται $k$ τιμές με όλες τις υπόλοιπες σταθερές. Σε κάθε περίπτωση αν γνωρίζουμε για κάποιες μεταβλητές τις βέλτιστες τιμές, αυτές είναι που χρησιμοποιούμε ως σταθερές, διαφορετικά επιλέγουμε αυθέρετες τιμές. Μετά από κάθε "ομάδα" δοκιμών για μια παράμετρο, επιλέγουμε τη βέλτιστη τιμή του. Στο τέλος της διαδικασίας, θα έχουν καταλήξει σε ένα σύνολο βέλτιστων τιμών των παραμέτρων $(x_1^{\prime},x_1^{\prime},x_2^{\prime},x_3^{\prime},[\;\dots],x_n^{\prime},)$.
Αν και αυτή η προσέγγιση είναι απλή και εύκολη στη κατανόηση και την εφαρμωγή δεν μπορούμε να γνωρίζουμε για τυχόν αλληλεπιδράσεις μεταξύ αυτών των $x_i$ παραμέτρων.

#### Παραγοντικός Σχεδιασμός ($n^k, 2^k$)

Έχει πολυπλοκότητα $Ο(n^k)$ πειραμάτων, όπου n τα επίπεδα προς εξαίταση για κάθε παράγοντα και κ οι παράγοντες που θα εξαιτάσουμε. Συνήθως, όπως και στη *΄σαρωση* βλέπε άνω κάνουμε έλεγχο σε δύο μόνο επίπεδα, ένα χαμηλό και ένα υψηλό $(\pm)$ αντίστοιχα. Τότε είναι $Ο(2^)$. Κρατάμε και ένα "βασικό επίπεδο" το οποίο αντιπροσωπεύεται από το 0.
Σε κάθε περίπτωση θα πρέπει να χρησιμοποιήσουμε ένα μαθηματικό μοντέλο που περιγράφη τη σχέση παραμέτρων-απόκρισης. Η γενική πορεία εργασίας μας είναι:

* Προκαταρκτικά Πειράματα (βρίσκουμε τα επιτρεπτά όρια των παραγώντων)
* Βρίσκουμε τις σημαντικές επιδράσεις παραγώντων (screening)
* Καθορίζουμε τα επίπεδα [???]
* Επιλέγουμε το μοντέλο (πχ $2^k$)
* Εκτελούμε πειράματα
* Επεξεργαζόμαστε στατιστικά τα αποτελέσματα μας (σημαντικότηα από συντελεστές, ANOVA, αλλα διαγράμματα)
* Ερμηνεύουμε τα αποτελέσματα και καταλήγουμε στις βέλτιστες συνθήκες

>**Παρατήρηση:**\
Εάν στο τέλος δεν έχουμε αποδεκτά αποτελέσματα, θα πρέπει πιθανότητα να σχεδιάσουμε ξανά τη διαδικάσία και να ξεκινήσουμε από την αρχή

#### Γραμμικό (Πολυπαραγωντικό) Μοντέλο

Είναι ουσιαστικά μια απλή γενίκευση του βασικού γραμμικού μοντέλου που χρησιμοποιούμε και στη καμπύλη βαθμονόμησης. Λειτουργεί με ανάλογο τρόπο αλλά αντί για μία μόνο ανεξάρτητη μεταβλητή, έχουμε n και όλους του κατά ζεύγοι συνδιασμούς τους:

$$
\def\arraystretch{1.5}
\begin{array}{cc}
\hat{y} = w_0 + \sum_{i=1}^{n\in {^+}\mathbb{N}^{*}}{w_ix_i} + \sum_{i=1}^{n_1\in\mathbb{N_1}^{+}}{\sum_{j>i}^{n_2\in\mathbb{N_2}^{+}}{w_{ij}\prod_{k=j}^{k\le i}{x_k}}}\\
\hat{y} = w_0 +w_1x_1+w_2x_2+w_3x_3+w_{12}x_1x_2+w_{13}x_1x_2+w_{23}x_1w_3+w_{123}x_1x_2x_3
\end{array}
$$

#### Quadratic Μοντέλο
Είναι μοντέλα με δευτεροβάθμιους όρους:
$$
\def\arraystretch{1.5}
\begin{array}{cc}
\hat y = \sum_{i=1}^{n\in\mathbb N} w_ix_ι +\sum_{i=1}^{n\in \mathbb {N}_1}\sum_{j>1}^{k\in \mathbb {{N}_2\le \mathbb N_1}}w_{ij}x_ix_j+\sum_{i=1}^{n\in\mathbb{N^+}}\prod_{i=1}^{n\in\mathbb{{N^+}}}{w_{iii,\dots}x_i^2}\\
\hat{y} = w_0 +w_1x_1+w_2x2+w_3x_3+w_{12}x_1x_2+w_{13}x_1x_2+w_{23}x_1w_3+w_{11}x_1^2+w_{22}x_2^2+w_{33}x_3^2
\end{array}
$$

Οι συντελεστές του εκάστοτε παράγωντα $x_ix_j$ περιγράφει και την ισχύ της αλληλεπίδρασης (όσο μεγαλύτερο, τόσο περισσότερη επιρροή στην απόκριση) αλλά και τον τύπο της επίδρασης, δηλαδή αν αυξάνει ή μειώνει την απόκριση. Επιπλέον οι όροι $x_ix_{j\ne i}$ περιγράφουνν τις αλληλεπιδράσεις μεταξύ των παραγώντων.

Μπορούμε επίσης να αποικονήσουμε ένα διάγραμα $x_i,x_j)$ και πάνω να απεικονήσουμε τις αποκρίσεις. Οι γραμμές που προκύπτουν είναι ισουψείς δηλαδή είναι ζεύγοι τιμών $x_i,x_j$
για τις οποίες η απόκριση έχει κάποια δεδομένη τιμή (και διαφορετική τιμή μεταξύ των καμπυλών).

#### Cubic Μοντέλο

Ανάλογα με πριν αλλά είναι τριτοβάθμια μοντέλα (με όρους $x_i^3$)

### Κλασματικός Παραγοντικός Σχεδιασμος

Είναι μια τεχνική που απορρίπτει τα μισά πειράματα καταλήγοντας σε $Ο(2^{k-1})$ αριθμό πειραμάτων. Αυτό μπορούμε να το κάνουμε απορρίπτωντας αλληλεπιδράσεις που δεν έχει ενδιαφέρον και δεν αλλοιώνουν τα αποτελέσματα μας. Υπάρχει και ο σχεδιασμό $Ο( 2^{k-2} )$. αν θέλουμε μεγαλύτερο αριθμό παραγώντων. Υπάρχουν πίνακες που δείχνουν αν σχεσμό αν είναι επιτρεπτός, ριψοκίνδυνος ή απαγορευμένος ο Ο(2^{k-1}). Για κάθε παράγοντα μπορούμε να εξάγουμε μια τιμή P-value μέσω της τεχνικής ANOVA.

### Κεντρικά Σημεία Σε Σχεδιασμό $2^k$

Με μόνο δύο σημείο μπορεί να μην ισχύει η υπόθεση οτι ο παράγωντας έχει γραμμική επίδαση πάνω στην απόκριση. Για το αντιμετοπήσουμε αυτό το φαινόμενο εισάγουμε κεντρικά σημεία τα οποία ταυτόχρονα επιτρέπουν και μια ανεξάρτητη εκτίμηση του σφάλματος.

>**Επαναλήψεις και Blocking:**\
Συνήθως δεν κάνουμε επαναλήψεις της διαδικασίας, για να είναι βεβαιότερα τα αποτελέσματα, διότι θα αυξηθεί υπερβολικά ο αριθμός των πειραμάτων που χρειάζονται. Αν κάτι πάει λάθος μπορούμε να κάνουμε επανάληψη και αν την κάνουμε τότε οι μετρήσεις χωρίζονται σε 'υπο-ομάδες' που ονομάζονται *blocks*. Με αυτό τον τρόπο επισημαίνουμε οτι κάθε block έχει διαφορετικές συνθήκες.

#### Διάγραμμα Box-Cox

To Box-Cox είναι ένα διάγραμμα υπολοίπων(SS)-$\lambda$ που δείχνει αν τα δεδομένα αποκλίνουν από την κανονική κατανομή, οπότε, μπορεί να χρειαστεί κάποιος μετασχηματισμός, όπως λογαρίθμηση ή ύψωση σε δύναμη.

## Άλλοι Σχεδιασμοί

### Συμμετρικοί Δευτέρου Βαθμού

Υπάρχουν και άλλοι πειρματικοί σχεδιασμοί, όπως ο *πλήρης τριών επιπέδων* ($Ο(3^k)$) και Box-Behnken που είναι $Ο(2k(k-1)+C_p )$ όπου $C_p$ ο αριθμός των κεντρικών σημείων με μόνο τρία επίπεδα $\{+1, 0 , -1\}$.  

#### Πλήρης Τριών Επιπέδων

Είναι $Ο(3^k)$ και απαιτεί πολύ μεγάλο αριθμό πειραμάτων γι αυτό και δεν χρησημποιείται γενικά. Πρακτικά σε κάθε περίπτωση ο κλασσικό σχεδιασμός είναι προτιμότερος.

#### Box-Behken

Σχεδιάστηκε με την επιλογή σημείων με διαθέτηση παραγώντων με τρία επίπεδα που ισαπέχουν $\{+1,0,-1\}$ και βασίζεται στην τοποθέτηση των σημείων σε μια υπερσφαίρα, και ισαπέχουν από το κεντρικό σημείο. Έχει κάποιο ενδιαφέρον γιατί απαιτεί σχετικά μικρό αριθμό πειραμάτων. Συγκεκριμένα είναι: $Ο(2k(k-1)+C_p)$, με $C_p$ κεντρικά σημεία και $k$ παράγωντες.


#### Κεντρικός Σύνθετος Σχχεδιασμός(CCD)

Στον *κεντρικό σύνθετο σχεδιασμό* εχουμε σχεδιασμό πλήρους ή κλασματικού που συνδιάζεται με ένα δεύτερο σχεδιασμό αστεριού (συνήθως), και ένα κεντρικό σημείο. 
Ο σχεδιασμός αστεριού έχει σημεία σε απόσταση $\alpha$ από το κέντρο.
Σε σχέση με τα τον Box-Behken έχουμε περισσότερα σημεία με περίπου τον ίδιο αριθμό σημείων ή και λίγα περισσότερα. Είναι $O(k^2+2k+C_p)$ με $C_p$ τον αριθμό των **επαναλαμβανόμενων μετρήσεων** ανά σημείο. Εδώ εξαιτάζουμε πέντε επίπεδα τιμών $\{-\alpha, -1,0+\alpha\}$. Η παράμετρος $\alpha$ εξαρτάται από τον αριθμό των πειραματων και μπορεί να εξαιταστεί και επίδραση της καμπυλότητας. Υπάρχουν τρεις υπο-κατηγορίες:

* *Εδροκεντρωμένος*
* *Περιστρέψημος*(Ομοιομορφία σφάλματος πρόβλεψης)
* *Εγγεγραμένος*

## Μεθοδολογία Απόκρισης Επιφάνειας

Είναι μια μαθηματικά περίπλοκη προσέγγιση που προσαρμώζει τα δεδομένα σε πολυονιμική εξίσωση τύπου απόκρισης- παράμετροι. Το αποτέλεσμα του μοντέλου είναι μια επιφάνεια.

### Επιθυμητότητα

Για πολλαπλές αποκρίσεις προς βελτιστοποίηση πρέπει να χρησιμοποιήσουμε μια συνάρτηση που εξαιτάζει κάποιο "συνδιασμό" των επιμέρους αποκρίσεων και βγάζει ένα συμβιβαστικό αποτέλεσμα τις βελτιστοποιεί όλες ταυτόχρονα, όσο καλύτερα γίνεται. Γι αυτό το σκοπό χρησημοποιούμε την εξίσωση Derringer με μεθοδολογία πολλαπλών κριτηρίων.

Για κάθε μεμονομένη απόκριση κατασκευάζουμε μια *συνάρτηση επιθυμητότητας* που δίνει μεμονομένους όρους
$d_i$ που είναι αδιάστατοι αριθμοί. Αυτοί οι όροι έχουν την εξής ιδιότητα, για $d_i=0$ η απόκριση είναι πλήρως ανεπιθύμητη, ενώ για $d_i=1$ είναι πλήρως επιθυμητή. Τότε η *συνάρτηση συνολικής επιθυμητότητας* θα είναι:
$$
D = [\prod_{i=1}^{n\in\mathbb{N}^+}{d_i}]^{\frac1n}
$$

Επομένως θα πρέπει να μεγιστοποιήσουμε αυτή τη συνάρτηση. Με την εισαγωγή συντελεστών ζύγισης ανά απόκριση μπορεί να αλλάξει η μορφή της, για παράδειγμα για να δώσουμε έμφαση στη ανώτατο ή το κατώτατο όριο ή κάποια συγκεκριμένη τιμή ενδιαφέροντος. Στη τελευταία περίπτωση  1 σημαίνει γραμμικότητα, >1 σημαίνει έμφαση στον στόχο και <1 σημαίνει λιγότερη έμφαση στον στόχο.
