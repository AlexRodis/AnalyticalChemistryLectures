# Βελτιστοποίηση Αναλυτικών Μεθόδων

## Εισαγωγή

Όταν ανάπτυσουμε μια νέα αναλυτική μεθόδο αλλά και όταν προσαρμώζουμε μια υπάρχουσα σε άλλους τύπους δειγμάτων, πρέπει να κάνουμε *βελτιστοποίηση* της.
>**Βελτιστοποίηση:**
\
Ονομάζεται η εύρεση αυτών των τιμών των πειραματικών παραμέτρων της μεθόδου που δίνουν τα καλύτερα δυνατά αποτελέσμα (*μεγιστοποιούνε την απόκλιση*).

Απόκριση ονομάζεται μια συνάρτηση ποιοτικού μεγέθους που μας ενδιαφέρει να ελαχιστοποιήσουμε ή να μεγιστοποιήσουμε - ανάλογα με το μέγεθος. Παραδείγματα απόκρισης είναι:

* Σήμα(S) - Μεγιστοποιούμε
* Όριο Ανίχνευσης - Ελαχιστοποιούμε
* Εύρος Γραμμικής Περιοχής - Μεγιστοποίηση
* Διαχωριστηκότητα Γειτονικών Χρωματογραφικών Κορυφών - Μεγιστοποιούμε

Εναλλακτικά, μπορεί να είναι και γραμμικός συνδιασμός παραμέτρων. Για παράδειγμα αν έχουμε μια χρωματογραφική μέθοδο απορρόφησης μπορούμε να επιλέξουμε να μεγιστοποιήσουμε την απορρόφηση, λαμβάνοντας υπ' όψιν δύο παραμέτρους, το pH και την  θερμοκρασία $\theta$. Οπότε, ζητάμε να βελτιστοποιήσουμε (μεγιστοποιήσουμε) τη συνάρτιση απόκρισης:
$$
A=f(pH,\theta)
$$

Αν μπορούσαμε να μετρήσουμε απόκριση για κάθε ζεύγος δυνατών τιμών $(pH,\theta)$ θα λαμβάναμε την *επιφάνεια απόκρισης*. Το παγκόσμιο μέγιστο της είναι το βέλτιστο ζεύγος, δηλαδή το ζεύγος τιμών $(pH_{opt},\theta_{opt})$ για το οποίο είναι $A_{max}$.

Ζητάμε τεχνικές βελτιστοποίησης που οδηγούν σε αναρίχηση προς το ανώτατο σημείο. Ζητάμε να φτάσουμε σε αυτό το σημείο στο μικρότερο αριθμό βημάτων, αποφεύγοντας τον "εγκλωβισμό" σε τοπικά μέγιστα και ελάχιστα.
Οι τρεις κύριες τεχνικές στη διάθεση μας είναι:

* Αναζήτηση Σχηματομορφής
* Διαδοχική Μεταβολή Ενός Παράγοντα
* Πολυπαραμετρικό Simplex

## Aναζήτηση Σχηματομορφής

Είναι ουσιαστικά μια προσπάθεια συστηματικής "χαρτογράφησης" της επιφάνειας. Έχει όμως πολυπλοκότητας Ο($k^n$) για k τιμές ανά παράμετρο και ν παραμέτρους.
Εκτός από την μεγάλη πολυπλοκότητα για n>2 εμφανίζονται συχνά απότομες μεταβολές κάνοντας δύσκολη την εύρεση παγκοσμίων μεγίστων.

![pattern search]()

### Παραγοντικός Σχεδιασμός

Ο *παραγοντικός σχεδιασμός* βασίζεται σε προσεκτική επιλογή κρίσημων παραμέτρων και μείωση του αριθμού τους σε μόνο δύο. Τότε είναι Ο($2^n$). Με την ίδια λογική λειτουργεί και ο κλασματικός παραγοντικός σχεδιασμός με Ο($\frac {1}{2}2^n$) και απαιτεί κάποια γνώση για το πως επιδριύν οι παράμετροι στο μέγεθος.

## Διαδοχική Μεταβολή Ενός Παράγοντα Τη Φορά

Είναι η ποιό απλή περίπτωση. Κρατάμε σταθερές όλες τις παραμέτρους εκτός από μία. Κάνουμε k μετρήσεις και λαμβάνουμε τη βέλτιστη. Επαναλαμβάνουμε για τις υπόλοιπες n-1 παραμέτρους κρατόντας ως σταθερή τιμή, τη βέλτιστη την οποία βρήκαμε. Συνήθως επαναλαμβάνουμε r φορές όλη τη διαδικασία οπότε είναι Ο(rnk). Κύριο μειονέκτημα είναι οτι δε λαμβάνουμε υπ' όψιν τυχόν αλληλεπιδράσεις μεταξυ αυτών. Δηλαδή, η βελτιστοποιήση μιας παραμέτρου αλλάζη την τιμή μιας άλλης. Σε τέτοιες περιπτώσεις είνια πολύ δύσκολο να εντοπίσουμε την πραγματικά βέλτιστη τιμή των πειραματικών παραμέτρων.

![ΔΜΕΠτΦ Επιτυχημένη]()
![ΔΜΕΠτΦ Αποτυχημένη]()

## Μέθοδος Simplex

Οι παραπάνω μέθοδοι αν και απλοϊκές πάσχουν από υψηλή πολυπλοκότητα και ανικανότητα να διχειρηστούν μη-ανεξάρτητες παραμέτρους. Επομένως χρειαζόμαστε μια μέθοδο που επιτρέπει την ταυτόχρονη μεταβολή πολλαπλών παραμέτρων με ταχεία σύγκλιση προς το βέλτιστο. Η ποιό αποτελεσματική τέτοια μέθοδος είναι η *Simplex*. Αρχικά αναπτύχθηκε ως μια *αριθμητική μέθοδος* για την ελαχιστοποίηση ή την μεγιστοποίηση μαθηματικών συναρτήσεων. Έχει αποδηχθεί ως αξιόπιστη και αποτελεσματική μέθοδος βελτιστοποίησης με μηχανισμό ανάδρασης\[sic\] ως αποφεύγονται οι λανθασμένες κινήσεις. Ο συνηθέστερος αλγόριθμος είναι αυτός των Nelder-Mead.
Έστω n-διάστατος χώρος για n εξαιταζόμενες παραμέτρους. Τότε:
>**Simplex** ονομάζεται το γεωμετρικό σχήμα που ορίζεται από τα n+1 σημεία του χώρου. Κάθε σημείο ονομάζεται κορυφή (vertex).

Η κάθε κορυφή ορίζεται από ένα διάνυσμα μορφής $(x_1,x_2,x_3,[\;\dots],x_n)$. Επιλέγουμε (τυχαία αρχικά) n+1 παραμέτρους και μετράμε τις αντίστοιχες αποκρίσεις. Αυτά τα σημεία ορίζουν ένα αρχικό Simplex. Τότε καθορίζουμε:
* Τη χειρότερη απόκριση (W)
* Την αμέσως χειρότερη (N)
* Την καλύτερη (B)
* Το κεντροειδές (C) -χωρίς το W σημείο
* Το συμμετρικό του W ως προς το κεντροειδές

Το σημείο R δίνει ένα σύνολο τιμών που θα μετρήσουμε, παίρνοντας την αντίστοιχη απόκριση. Εκτελούμε την αντικατάσταση:
$$
W\rightarrow R\\
C(\bar{x_{1i}},\bar{x_{2i}}, [\;\dots])
$$
Έτσι ολοκληρώνεται ένας κύκλος και έχουμε ένα νέο Simplex. Επαναλαμβάνουμε μεχρι κάποια συνθήκη τερματισμού, όπως μέγιστες επαναλήψεις ή μέχρη να συγκλίνει (βλ. παρακάτω)