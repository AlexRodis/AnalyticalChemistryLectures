# Αβεβαιότητα Χημικών Μετρήσεων - Monte Carlo

## Εισαγωγή

Προτάθηκε πρώτη φορά το 2008 στο συμπλήρωμα της οδηγίας GUM για εκτίμηση αβεβαιότητας. Από το 2012 συμπεριλαμβάνεται και στην οδηγία EURACHEM. Γενικά ως μέθοδος βασίζεται στην αρχή του συνδιασμού ***συναρτήσεων κατανομής πιθανότητας (PDF)***.

Αν γνωρίζω την κατανομή των επί μέρους τμημάτων, μπορούμε να εκτιμήσουμε την κατανομή του συνολικού αποτελέσματος. Η μεθοδολογία βασίζεται σε μια μηχανή παραγωγής πληθυσμού, δηλαδή πρακτικά κάποιον αλγόριθμο που παράγει αριθμούς που συμμορφώνονται σε κάποια επιλεγμένη κατανομή (πχ κανονικ).

Δηλαδή ορίζοντας στον αλγόριθμο τις κατανομές ενδιαφέροντος, αυτός παράγει μεγάλο αριθμό "τυχαίων" αριθμών και τα συνδιάζει σε μια νέα κατανομή. Ο καθορισμός της κατανομής ενός μεγέθους απαιτεί μεγάλο αριθμό δεδομένων (κατά EURACHEM 100.000-1.000.000).

## Μηχανή Παραγωγής Τυχαίων Αριθμών

Αυτή η μηχανή δεν είναι παρά ένας αλγόριθμος που μπορεί να παράγει "τυχαίους" αριθμούς που συμμορφώνονται σε κάποια επιθυμητή κατανομή.
Ο υπολογισμός της αβεβαιότητας κάνει τυχαία δειγματοληψία από κάθε παράγωντα που επιδρά στην αβεβαιότητα, αυτοί εφαρμώζονται στην σχέση υπολογισμού και τέλος υπολογίζεται η τυπική απόκλιση άρα και την τυπική αβεβαιότητα. Σημαντικός είναι ο αριθμός δοκιμών, δηλαδή το πλήθος των αριθμών που θα παραχθούν για κάθε μέγεθος και που θα υπολογιστούν. Η διαδικασία μπορεί να γίνει με προκαθορισμένο αριθμό (τουλάχιστον 1.000.000 κατά GUM) ή να χρησιμοποιήσω προσαρμωσμένο αριθμό, οπότε η προσομοίωση θα σταματήσει όταν φτάσουμε σε μια προκαθορισμένη ακρίβεια (σταθεροποίηση του αποτελέσματος). Στη πράξη το $10^6$ είναι μεγάλο και πολύ χρονοβόρο (ανάλογα και με το μηχάνημα βέβαια).

Στον προσαρμωσμένο αριθμό δοκιμών το κριτήριο σταθεροποίησης είναι:
> **Κριτήριο Σταθεροποίησης:** Είναι δύο φορές η τυπική απόκλιση του αποτελέσματος πρέπει να είναι μικρότερη από την αριθμητική ανοχή της αβεβαιότητας
> $$
2SD_{result}< \delta_{???}
> $$

>**Αριθμητική ανοχή ($δ$)** είναι το ημιεύρος του μικρότερου δυνατού διαστήματος που περικλείει όλους εκείνου τους αριθμός που μπορούν να εκφράσουν ένα αποτέλεσμα.

Έτσι για παράδειγμα αν η αβεβαιότητα σιφωνίου $50;mL$ είναι $0,02\;mL$ το διάστημα είναι $[0,015,0,025]$ άρα το εύρος είναι $0,025-0\;,015=0,01$ και $0,01/2=0,005$. Η αριθμητική ανοχή είναι $\delta=0,05$. Για ένα σημαντικό είναι $0,01\delta=0.005$ και για δύο σημαντικά $0,010\;\delta=0.0005$.

Γενικά ο προσαρμωσμένος τρόπος έχει νοήμα περισσότερο σε εξαιρετικά πολύπλοκα συστήματα με πολλές παραμέτρους, όπου ο υπολογισμός είναι χρονικά δαπανηρός.

Από τα δεδομένα προσομοίωσης και μέσω υπολογιστών υπολογίζουμε τα:
* Μέση Τιμή
* Τυπική Απόκλιση (Αβεβαιότητα)
* Διάστημα Εμπιστοσύνης
* Σύναρτηση Κατανομής Τελικού Αποτελέσματος

> $$
\hat{y}=\frac1M ......
> $$

> $$ 
??????
> $$

## Διάστημα Εμπιστοσύνης

Μπορών να υπολογίσω το διάστημα εμπιστοσύνης είται συμμετρικά είτε ως μικρότερο δυνατό. Στο συμμετρικό συμπεριλαμβάνονται όλες οι τιμές της PDF, απορρίπτωντας το ίδιο ποσοστό στα άκρα και συμμετρικά (πχ για CI 95%  αφαιρείται το 2,5%).

Αυτή η μέθοδος είναι προβληματική εάν η PDF είναι ασύμμετρη, διότι θα απορριφθούν περισσότερες τιμές στο ένα απ' τα δύο άκρα. Τότε κάνουμε το μικρότερο δυνατό διάστημα, δηλαδή εκτιμούμε όλα τα πιθανά δαιστήματα που περικλύουν την επιθυμητή στάθμη εμπιστοσύνης $(\%p)$ και υπολογίζουμε τη διαφορά των πιθανοτήτων του κάτων από του πάνω άκρου. Το επιθυμητό διάστημα είναι αυτό με τη μικρότερη διαφορά.

### Παράδειγμα

Ζυγίζουμε δείγμα πλαστικού ομογενοποιούμε και μετράμε $Cd$ με $AAS$. Τότε:
$$
[Cd](\frac{mg}{Kg}=\frac{C(mg/L)*V(mL)}{m(g)})
$$

||Κατανομή|Μέση Τιμή|Τυπική Απόκλιση|
-----|--------|------|------
?????|?????|??????|?????

> **Παρατήρηση:** Αποδεικνύεται στη βιβλιογραφία ότι όταν ακουλουθείται κανονική κατανομή η αβεβαιότητα δεν θα πρέπει να διαφέρει πολύ μετά Monte Carlo και EURACHEM.

## Σύγκριση

Η EURACHEM βασίζεται στη διάδοση αβεβαιότητα και το Κεντρικό Οριακό Θεώρημα, ενώ η Monte Carlο σε κατανομές. Στη EURACHEM θα πρέπει το μοντέλο να είναι γραμμικό και κάθε πηγή αβεβαιότητας να είναι ανεξάρτητη, ενώ στη Monte Carlo δεν υπάρχει κάποια απαίτηση. Κύριο μειονέκτημα της Monte Carlo είναι το οτι δεν είναι πάντα γνωστή η κατανομή κάποιου μεγέθως (της αβεβαιότητας). Επιπλέον η πολθπλοκότητα του μοντέλου μπορεί να αυξήσει το χρόνο αλλά αυτό είναι πρακτικά σπάνιο.

Η EURACHEM συμπεριλαμβάνει και οδηγίες για να γίνει στο EXCEL

